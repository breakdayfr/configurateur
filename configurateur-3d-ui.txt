<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Configurateur compact responsive</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  
  <!-- Import du script model-viewer -->
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  
  <style>
body { background: #f4f7fa; margin:0; font-family: 'Oswald', Arial, sans-serif; }
#configurateur { display: flex; min-height: 100vh;}
.sidebar-products { width: 320px; background: #fafaff; border-right: 2px solid #e9ecef; padding: 17px 9px 20px 9px; display: flex; flex-direction: column; gap: 16px;}
.section-title { font-size: 1em; font-weight: 700; color: #232850; margin-bottom:8px; display:block; }
.custom-block { background: #fff; border:2px solid #e3e7ef; border-radius: 11px; padding: 13px 12px 10px 12px; margin-bottom: 7px; box-shadow: 0 1px 6px #4169e109;}
.custom-block.info-tip {font-size:0.90em;background:#fffbe7;border:2px solid #ffd23c;display:flex;flex-direction:column;align-items:flex-start; gap:4px;margin-top:10px;}
.custom-block.info-tip .material-icons {font-size:1em;vertical-align:middle;}
.custom-block.info-tip b {margin-bottom:1px;}
.custom-block.info-tip .block-btn {margin-top:3px;}
.mode-switch-row {display:flex;gap:14px;}
.radio-mode { display:flex; align-items:center; gap:5px; font-size:0.97em; cursor:pointer; font-weight:600; }
.radio-mode input[type="radio"] {display:none;}
.radio-custom { width:15px;height:15px; border-radius:50%; border:2px solid #4169e1; margin-right:2px; background:#fff; }
.radio-mode input[type="radio"]:checked + .radio-custom { background:#4169e1; box-shadow:0 0 0 2px #e3ecfa; }
.prefait-carousel { display:flex; gap:8px; margin:8px 0 2px 0; flex-wrap:wrap; min-height:40px;}
.model-thumb {display:flex; flex-direction:column; align-items:center; gap:1px; padding:3px 5px 5px 5px; border-radius:6px; border:2px solid #e9ecef; background:#f6f8fc; cursor:pointer; box-shadow:0 1px 5px #23285008; font-size:.95em; color:#232850; min-width:38px; transition:border .13s, box-shadow .11s, background .13s;}
.model-thumb.selected, .model-thumb:hover { border-color: #4169e1; background: #e9f1ff; box-shadow:0 2px 10px #4169e120;}
.model-thumb img{ display:block; width:32px; height:32px; border-radius:5px; }
.model-thumb span{ margin-top:1px; font-size:.9em; }
.filters-block {display:flex;flex-direction:column;gap:7px;}
.select-filter { border-radius:5px; border:2px solid #e3e7ef; background:#fafbff; font-size:.97em; padding:4px 7px;margin-bottom:4px; color:#232850;font-weight:600;}
.input-filter { border-radius:5px; border:2px solid #e3e7ef; background:#fafbff; font-size:.96em; padding:4px 7px; margin-bottom:2px; color:#232850;}
.products-flex { display:flex; flex-wrap:wrap; gap:7px; align-items: flex-start; margin: 7px 0 0 0; min-height:46px;}
.product-mini { background: #f4f6fa; border:2px solid #e9ecef; box-shadow: 0 1px 8px #4169e10a; padding:6px 4px 5px 4px; border-radius:7px; display:flex;flex-direction:column;align-items:center;gap:2px; position:relative; min-width:38px; cursor:pointer; transition:border .13s, background .13s;}
.product-mini.selected, .product-mini:hover { border-color:#38e54d; background:#e8fbf0; }
.product-mini img {width: 32px;height: 32px; border-radius:6px;}
.product-mini span {font-size:.96em;color:#232850; margin-top:1px;}
.del-btn {position:absolute; top:2px;right:3px; background: none; border:none; color:#d64545; font-size:.9em;cursor:pointer;padding:0;line-height:1; border-radius:7px; transition:background .11s;}
.del-btn:hover{ background:#fae3e3;}
.add-product-btn { background:#4169e1; color:#fff; display:flex; flex-direction:column;align-items:center;justify-content:center;border-radius:7px;border:2px solid #4169e1; font-weight:bold; min-width:40px; padding:9px 7px 7px 7px; cursor:pointer;font-size:.95em; box-shadow:0 1px 6px #4169e116;transition:background .13s; margin-top:8px;}
.add-product-btn:hover {background:#38e54d; color:#fff; border-color:#38e54d;}
.add-product-btn .material-icons {font-size:1.11em;}
/* --- CENTRAL --- */
#central-content{ flex:1; min-width:0; display:flex; flex-direction:column; align-items:center; justify-content:flex-start;}
.prefait-header {margin-top:34px; display:flex;align-items:end; justify-content:left;gap:22px 15px; flex-wrap:wrap;}
.prefait-header h2 {font-size:1.8em;font-weight:900; color:#232850; margin-right:12px;margin-bottom:0;line-height:1.1;}
.filters-center {display:flex;gap:8px;align-items:center;}
.filters-center .input-filter { font-size:1.11em;padding:8px 12px;}
.filters-center .select-filter {font-size:1.13em; min-width:110px;}
.designs-grid { width:94%; margin:36px auto 0 auto; display:grid; grid-template-columns: repeat(auto-fit, minmax(250px,1fr)); gap:38px 48px;}
.design-card { background:#fff;border-radius:18px;border:2.7px solid #eceef4; box-shadow:0 2px 14px #4169e10f; padding:22px 17px 28px 17px; display:flex;flex-direction:column;align-items:center;position:relative; transition:border .13s, box-shadow .17s, transform .14s; cursor:pointer; min-height:298px; animation: popfadeIn .38s cubic-bezier(.19,.61,.45,1.00);}
@keyframes popfadeIn { 0%{transform:scale(.92) translateY(30px); opacity:0;} 90%{transform:scale(1.02);} 100%{transform:scale(1) translateY(0); opacity:1;}}
.design-card.selected, .design-card:focus-within, .design-card:hover { border-color: #4169e1; filter: drop-shadow(0 4px 17px #4169e180); transform: scale(1.04);}
.design-card img { width:132px;height:132px;object-fit:cover; border-radius:11px; box-shadow:0 0 10px #23285011;margin-bottom:12px; background:#e9ecef; transition:box-shadow .17s;}
.design-card .card-title { font-size:1.22em;font-weight:800; color:#232850; margin-bottom:7px;margin-top:1px;}
.design-card .palette { display: flex; gap:6px;margin-bottom:13px;}
.design-card .color-dot { width:21px;height:21px;border-radius:50%; display:inline-block; border:1.8px solid #fff; box-shadow:0 1px 6px #4169e181;}
.design-card .choose-btn { margin-top:auto; margin-bottom:2px; font-size:1.21em; font-weight:800; padding:10px 24px; border-radius:7px; border:none; color:#fff;background:#4169e1;cursor:pointer; transition:background .13s, color .09s; box-shadow:0 2px 8px #4169e135;}
.design-card .choose-btn:hover {background:#38e54d; color:#19442b;}
.design-card .card-desc { font-size:1.09em;color:#5a677a;text-align:center;margin-bottom:8px;margin-top:0;}

/* Style pour le model-viewer 3D */
.model-viewer-container { 
  margin: 38px auto; 
  max-width: 98vw; 
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 15px;
}

model-viewer {
  width: 600px;
  height: 400px;
  border: 2.2px solid #4169e1;
  border-radius: 10px;
  background: #f8fbff;
  box-shadow: 0 1.5px 8px #4169e120;
  --poster-color: #f8fbff;
  --progress-bar-color: #4169e1;
}

.model-controls {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  justify-content: center;
}

.model-btn {
  background: #4169e1;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 6px;
  cursor: pointer;
  font-family: 'Oswald', Arial, sans-serif;
  font-weight: 600;
  transition: background 0.2s;
}

.model-btn:hover {
  background: #38e54d;
}

.model-btn.active {
  background: #38e54d;
  box-shadow: 0 0 0 2px #38e54d40;
}

.sidebar-custom { width: 245px; background: #fafaff; border-left: 2px solid #e9ecef; padding: 17px 8px; box-shadow:0 2px 11px #4169e109; display: flex; flex-direction: column; gap: 13px; align-items: stretch;}
.sidebar-custom .custom-block { border-radius: 9px; box-shadow: 0 1px 4px #4169e114; background: #fff; border:2px solid #e3e7ef; padding: 9px 8px 7px 10px; margin: 0 0 8px 0; font-size:.96em;}
.sidebar-custom label, .sidebar-custom .custom-block label { font-family: "Oswald", Arial, sans-serif;font-size:.98em;color: #232850; margin-bottom:3px; font-weight: 700;letter-spacing:.01em;}
.sidebar-custom .color-palette { margin: 6px 0 1px 0; display: flex; gap:9px; flex-wrap: wrap;}
.sidebar-custom .color-dot { width: 30px; height: 30px; border-radius: 50%; border: 2px solid #e6eaf4; box-shadow: 0 1px 7px #4169e109; font-size:.98em; cursor: pointer; margin-bottom: 2px; transition: border 0.13s; position:relative; background-clip:padding-box; display:flex;align-items:center;justify-content:center;}
.sidebar-custom .color-dot.custom-picker-trigger { border-style: dashed; }
.sidebar-custom .custom-color-picker { position: absolute; z-index: 99; margin-top: 7px; left: 6vw; background: #fff; width: 180px; border: 2px solid #e9ecef; border-radius: 9px; padding: 11px 7px 8px 9px; box-shadow: 0 5px 17px #4169e144; font-size: 0.93em;}
.sidebar-custom .pattern-gallery { margin: 8px 0 5px 0; display: flex; gap: 6px;}
.sidebar-custom .pattern-thumb {width: 33px; height: 23px; border-radius: 4px; border: 2px solid #e2e6ec; background: #f7f7fa; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: border 0.13s, box-shadow 0.10s;}
.sidebar-custom .pattern-thumb.selected, .sidebar-custom .pattern-thumb:hover {border-color: #4169e1; box-shadow: 0 1px 3px #4169e120;}
.sidebar-custom .pattern-img-placeholder { width: 17px; height: 12px; background: #cecece; border-radius: 2px; display: flex; align-items: center; justify-content: center; font-size: .93em; color: #656565; font-family: "DM Sans", Arial, sans-serif; font-weight: 700; letter-spacing: 0.04em; user-select: none;}
.sidebar-custom .custom-input {width: 99%;margin: 3px 0 3px 0; padding: 3px 6px; border-radius: 5px; border: 2px solid #e9ecef; font-size: .95em; background: #f2f5fd;}
.sidebar-custom .text-list {margin: 2px 0;}
.sidebar-custom .text-list span { display:inline-block; background: #f5f7fa; border-radius:3px; padding:2px 5px 2px 5px; margin:0 4px 3px 0;}
.sidebar-custom .mini-btn { border: none; background: transparent; cursor: pointer; padding: 0 2px; font-size: 0.97em;}
.sidebar-custom .block-btn { display: inline-block; background: #f8f9fa; border: 2px solid #4169e1; border-radius: 4px; padding: 4px 7px; margin: 5px 4px 0 0; font-weight: 700; color: #21337a; cursor: pointer; font-size:.98em;}
.sidebar-custom .block-btn:hover {background: #e9f9ff; border-color: #38e54d; color: #187337;}
.sidebar-custom .logo-thumbs {display: flex; gap: 5px; margin: 5px 0;}
.sidebar-custom .logo-img {width: 19px; height: 19px; border-radius: 3px; border: 2px solid #e9ecef;}
.sidebar-custom .drag-zone {border: 2px dashed #38e54d; background: #f8fff8; border-radius: 6px; text-align: center; color: #257942; font-size: 0.92em;padding: 5px 2px; margin: 3px 0 0 0;}
.sidebar-custom .placement-btns {display: flex; flex-wrap: wrap; gap: 4px; margin-top: 2px;}
.sidebar-custom .placement-btns button {padding: 3px 7px; font-size: 0.95em; background: #f7f6fd; border-radius: 4px; border: 1.2px solid #cbd6ee; cursor: pointer;}
.sidebar-custom .placement-btns button:hover {background: #e9f0ff; border-color: #4169e1;}
/* BARRE BAS augment√©e */
.bottom-bar-pro { position: fixed; left: 0; right: 0; bottom: 0; display: flex; background: #fff; border-top: 2.5px solid #e9ecef; padding: 17px 2vw 17px 2vw; height: 74px; z-index: 100; column-gap: 14px; justify-content: center; align-items: stretch; box-sizing: border-box;}
.bar-btn { display: flex; align-items: center; justify-content: center; gap: 15px; border-radius: 15px; border: 2.5px solid #e9ecef; font-family: 'Oswald', Arial, sans-serif; font-size: 1.18em; font-weight: 700; color: #232850; background: #f8f9fa; box-shadow: 0 1.5px 13px #4169e109; padding: 18px 32px; margin: 0 2px; min-width: 75px; max-width:270px; white-space: nowrap; height: 100%; cursor: pointer; outline: none; position: relative; user-select: none;}
.bar-btn .material-icons { font-size: 1.23em;}
.bar-btn .button-label { font-size: 1.15em; font-family: inherit; font-weight: 900;}
.bar-btn.action {background: #4169e1; color: #fff; border-color: #4169e1; box-shadow: 0 2.5px 20px #4169e135; font-size:1.15em;}
.bar-btn.action .price-in-btn {background:#fff; color:#4169e1;border-radius:8px; font-size: 0.95em; font-weight:bold; display:inline-block; margin-left:16px;padding:2px 13px;}
.bar-btn.action:hover, .bar-btn.action:focus { background: #38e54d; color: #19442b; border-color: #38e54d;}
.bar-btn.validation { border-color: #38e54d; color: #187337; background: #f5fcf7;}
.bar-btn.validation:hover, .bar-btn.validation:focus { background: #ecfcf3;}
.bar-btn.utility { border-color: #e9ecef; color: #353f5b; background:#f8f9fa;}
.menu-dropdown {position:relative; display:inline-block;}
.menu-dropdown .dropdown-content { position:absolute; bottom: 110%; left: 0; min-width:140px; background:#fff; box-shadow:0 4px 10px #23285021; border-radius:8px; z-index:222; border:2px solid #e9ecef; display: flex; flex-direction:column; opacity:0; visibility:hidden; pointer-events:none; transform: scale(0.93) translateY(8px); max-height:0; padding:0; transition: all .17s cubic-bezier(.53,.04,.67,.91);}
.menu-dropdown.open .dropdown-content {opacity:1; visibility:visible; pointer-events:auto; transform: scale(1) translateY(-8px); max-height:320px; padding:6px 0; animation: growMenuUp .17s;}
@keyframes growMenuUp { 0% { opacity:0; transform:scale(.95) translateY(30px);} 100%{opacity:1; transform:scale(1) translateY(-8px);} }
.dropdown-content button { background:none; border:none; text-align:left; font-family:inherit; font-size:1.09em; color:#232850; cursor:pointer; padding:10px 18px; min-width:90px; transition:background .12s, color .13s; border-radius: 6px; opacity:1; outline: none;}
.dropdown-content button:hover { background: #e5eefe; color: #4169e1; }
.dropdown-separator { border-top: 1.2px solid #f0f2f5; margin: 6px 0;}
.dropdown-content button.destructive { color: #d64040;}
.dropdown-content button.destructive:hover { background: #fff0f0; color: #a53024;}

/* Responsive pour mobile */
@media (max-width: 768px) {
  model-viewer {
    width: 90vw;
    height: 300px;
  }
  .model-controls {
    flex-direction: column;
    align-items: center;
  }
}
  </style>
</head>
<body>
<div id="configurateur">
  <!-- BARRE GAUCHE -->
  <aside class="sidebar-products" id="sidebar-products">
    <div class="custom-block">
      <label class="section-title">Type de personnalisation :</label>
      <div class="mode-switch-row">
        <label class="radio-mode">
          <input type="radio" name="designMode" value="prefait" checked>
          <span class="radio-custom"></span>
          Mod√®le pr√©-fait
        </label>
        <label class="radio-mode">
          <input type="radio" name="designMode" value="libre">
          <span class="radio-custom"></span>
          Cr√©ation libre
        </label>
      </div>
      <div class="prefait-carousel" id="prefait-carousel">
        <div class="model-thumb selected" data-label="A"><img src="https://dummyimage.com/32x32/4169e1/fff&text=A" alt="Mod√®le A"><span>Storm</span></div>
        <div class="model-thumb" data-label="B"><img src="https://dummyimage.com/32x32/ffd23c/fff&text=B" alt="Mod√®le B"><span>Blitz</span></div>
        <div class="model-thumb" data-label="C"><img src="https://dummyimage.com/32x32/38e54d/fff&text=C" alt="Mod√®le C"><span>Classic</span></div>
        <div class="model-thumb" data-label="D"><img src="https://dummyimage.com/32x32/181c28/fff&text=D" alt="Mod√®le D"><span>Darkline</span></div>
      </div>
    </div>
    <div class="custom-block filters-block">
      <label class="section-title">Filtres produits :</label>
      <select class="select-filter" id="prodCat">
        <option value="">Cat√©gorie : Tout</option>
        <option>Maillots</option>
        <option>Hoodies</option>
        <option>Accessoires</option>
      </select>
      <select class="select-filter" id="prodCut">
        <option value="">Coupe : Toutes</option>
        <option>Unisexe</option>
        <option>Femme</option>
        <option>Enfant</option>
      </select>
      <input class="input-filter" id="prodSearch" placeholder="Recherche produit..." autocomplete="off"/>
    </div>
    <div class="custom-block">
      <label class="section-title">Produits √† personnaliser :</label>
      <div class="products-flex" id="productsFlex"></div>
      <button class="add-product-btn" type="button" id="addProductBtn">
        <span class="material-icons">add</span>
        <span>Ajouter un produit</span>
      </button>
    </div>
    <div class="custom-block info-tip" id="leftTipBlock" style="display:none;">
      <span class="material-icons">help_outline</span>
      <b>Astuce :</b> D√©placez votre logo, motif ou texte avec la souris ou le doigt.
      <button class="block-btn" style="margin-top: 4px">Voir le tutoriel ‚ü∂</button>
    </div>
  </aside>
  
  <!-- CENTRAL & DROITE, barres compactes -->
  <main id="central-content">
    <div id="block-prefait">
      <div class="prefait-header">
        <h2>S√©lectionnez un design pr√©-fait</h2>
        <div class="filters-center">
          <input class="input-filter" id="searchDesign" placeholder="Rechercher un design..."/>
          <select class="select-filter" id="styleFilter">
            <option value="">Style : Tous</option>
            <option>Sport</option>
            <option>Minimaliste</option>
            <option>Pop</option>
            <option>Club</option>
          </select>
          <select class="select-filter" id="mainColorFilter">
            <option value="">Couleur principale : Toutes</option>
            <option>Bleu</option>
            <option>Jaune</option>
            <option>Vert</option>
            <option>Noir</option>
            <option>Orange</option>
          </select>
        </div>
      </div>
      <div class="designs-grid" id="designsGrid"></div>
    </div>
    
    <div id="block-libre" style="display:none;width:100%;">
      <div class="model-viewer-container">
        <model-viewer 
          id="maillot3d"
          src="maillot.glb" 
          alt="Maillot e-sport en 3D"
          camera-controls
          auto-rotate
          auto-rotate-delay="3000"
          rotation-per-second="20deg"
          environment-image="neutral"
          shadow-intensity="1"
          exposure="1"
          ar
          ios-src="maillot.usdz">
          
          <!-- Message de chargement -->
          <div slot="progress-bar" style="display: flex; align-items: center; justify-content: center; height: 100%; font-family: 'Oswald', Arial, sans-serif; color: #4169e1; font-weight: 600;">
            <span class="material-icons" style="margin-right: 8px; animation: spin 1s linear infinite;">autorenew</span>
            Chargement du mod√®le 3D...
          </div>
          
          <!-- Bouton AR pour mobile -->
          <button slot="ar-button" class="model-btn">
            <span class="material-icons">view_in_ar</span>
            Voir en r√©alit√© augment√©e
          </button>
        </model-viewer>
        
        <!-- Contr√¥les pour le mod√®le 3D -->
        <div class="model-controls">
          <button class="model-btn" id="resetCamera">
            <span class="material-icons">360</span>
            Vue par d√©faut
          </button>
          <button class="model-btn" id="toggleRotation">
            <span class="material-icons">sync</span>
            Auto-rotation
          </button>
          <button class="model-btn" id="changeColor">
            <span class="material-icons">palette</span>
            Changer couleur
          </button>
        </div>
      </div>
    </div>
  </main>
  
  <aside class="sidebar-custom" id="sidebarCustom" style="display:none;">
    <div class="custom-block" style="position: relative">
      <label>Couleurs :</label>
      <div class="color-palette">
        <div class="color-dot" style="background: #4169e1" data-color="#4169e1"></div>
        <div class="color-dot" style="background: #38e54d" data-color="#38e54d"></div>
        <div class="color-dot" style="background: #ffd23c" data-color="#ffd23c"></div>
        <div class="color-dot" style="background: #181c28" data-color="#181c28"></div>
        <div class="color-dot custom-picker-trigger" style="background: linear-gradient(135deg, #fff 60%, #38e54d 120%); border-style: dashed;"><span style="color: #4169e1;font-size: 1.18em;position: absolute;left: 50%;top: 54%;transform: translate(-50%, -56%);opacity: 0.7;">+</span></div>
      </div>
      <div class="custom-color-picker" id="customColorPicker" style="display: none">
        <label>Couleur personnalis√©e :</label>
        <input type="color" id="colorField" value="#4169e1" style="width: 32px; height: 23px; border:2px solid #e9ecef;border-radius:7px;padding:1px;" />
        <div style="margin: 5px 0 4px 0">
          <span class="picker-label">CMJN :</span>
          <input type="number" min="0" max="100" id="cInput" class="cmjn-input" placeholder="C" style="width:22px;"/>
          <input type="number" min="0" max="100" id="mInput" class="cmjn-input" placeholder="M" style="width:22px;"/>
          <input type="number" min="0" max="100" id="yInput" class="cmjn-input" placeholder="J" style="width:22px;"/>
          <input type="number" min="0" max="100" id="kInput" class="cmjn-input" placeholder="N" style="width:22px;"/>
        </div>
        <button class="block-btn" style="margin-top: 2px" onclick="validateCMJN()">Valider la couleur</button>
        <button class="picker-close" onclick="closePicker()" style="position: absolute;top: 4px;right: 6px;font-size: 1em;background: none;border: none;color: #888;cursor: pointer;">‚úï</button>
      </div>
    </div>
    <div class="custom-block"><label>Pattern / Motif :</label>
      <div class="pattern-gallery">
        <div class="pattern-thumb selected"><div class="pattern-img-placeholder">img</div></div>
        <div class="pattern-thumb"><div class="pattern-img-placeholder">img</div></div>
        <div class="pattern-thumb"><div class="pattern-img-placeholder">img</div></div>
        <div class="pattern-thumb"><div class="pattern-img-placeholder">img</div></div>
      </div>
      <div style="margin: 4px 0 2px 0"><button class="block-btn">Importer un pattern</button></div>
      <div class="drag-zone">Ou d√©posez votre motif ici<br /><span style="font-size: .93em; color: #888">(PNG, SVG, GIF...)</span></div>
    </div>
    <div class="custom-block"><label>Textes :</label>
      <input class="custom-input" placeholder="Ajoutez un texte" />
      <div class="text-list">
        <span>Pseudo <button class="mini-btn" title="Modifier">‚úèÔ∏è</button><button class="mini-btn" title="Supprimer">üóëÔ∏è</button></span>
        <span>Slogan <button class="mini-btn" title="Modifier">‚úèÔ∏è</button><button class="mini-btn" title="Supprimer">üóëÔ∏è</button></span>
      </div><button class="block-btn">Ajouter un texte</button>
    </div>
    <div class="custom-block"><label>Logos / Sponsors :</label>
      <button class="block-btn">Ajouter un logo</button>
      <div class="logo-thumbs" style="margin-top: 4px">
        <img src="https://dummyimage.com/19x19/4169e1/fff&text=L" alt="logo" class="logo-img"/>
        <img src="https://dummyimage.com/19x19/38e54d/fff&text=S" alt="logo" class="logo-img"/>
      </div><div class="drag-zone">Ou d√©posez vos fichiers ici</div>
    </div>
    <div class="custom-block"><label>Positionnement :</label>
      <div class="placement-btns"><button title="Aligner au centre">‚≠Æ</button>
        <button title="Retourner horizontalement">‚áÜ</button>
        <button title="Mettre devant">‚Üë</button>
        <button title="Mettre derri√®re">‚Üì</button></div>
      <div style="margin: 4px 0 0 0"><button class="block-btn">‚Ü©Ô∏è</button>
        <button class="block-btn">‚Ü™Ô∏è</button>
        <button class="block-btn">üîç</button></div>
    </div>
  </aside>
</div>

<nav class="bottom-bar-pro" id="bottomBarPro" style="display:none;">
  <div class="menu-dropdown" data-menu="tools">
    <button class="bar-btn utility" type="button"><span class="material-icons">build</span><span class="button-label">Outils</span></button>
    <div class="dropdown-content">
      <button>Dupliquer le design</button><button>Importer un gabarit</button><button>Exporter en PDF/SVG</button>
      <div class="dropdown-separator"></div>
      <button>Afficher les guides</button><button>Afficher la grille de rep√®re</button><button>Param√®tres avanc√©s</button>
      <div class="dropdown-separator"></div>
      <button class="destructive">R√©initialiser</button>
      <button>Historique / Annuler</button>
    </div>
  </div>
  <div class="menu-dropdown" data-menu="collab">
    <button class="bar-btn utility" type="button"><span class="material-icons">groups</span><span class="button-label">Collaboration</span></button>
    <div class="dropdown-content">
      <button>Partager la configuration</button><button>Lancer un vote d'√©quipe</button><button>Voir les votes / r√©sultats</button><button>Copier le lien de vote</button>
      <div class="dropdown-separator"></div>
      <button>Demander un feedback express</button>
    </div>
  </div>
  <div class="menu-dropdown" data-menu="save">
    <button class="bar-btn validation" type="button"><span class="material-icons">save</span><span class="button-label">Sauvegarder</span></button>
    <div class="dropdown-content">
      <button>Sauvegarder la configuration</button><button>Enregistrer sous‚Ä¶</button><button>Historique des sauvegardes</button><button>Charger une configuration</button>
      <div class="dropdown-separator"></div>
      <button>Exporter en PNG</button><button>Exporter en JPG</button>
      <div class="dropdown-separator"></div>
      <button>Mettre en favori</button><button>Sauvegarder et partager un lien</button>
    </div>
  </div>
  <button class="bar-btn action" type="button" style="min-width:110px;">
    <span class="material-icons" style="font-size:1.10em;">shopping_cart</span>
    <span class="button-label">Commander</span>
    <span class="price-in-btn">49 ‚Ç¨</span>
  </button>
</nav>

<script>
const designsData = [
  { name:"Storm Blue", style:"Sport", mainColor:"Bleu", img:"https://dummyimage.com/180x180/4169e1/fff&text=Storm+Blue", desc:"Un design dynamique pour les √©quipes ambitieuses.", palette:["#4169e1", "#f2f2f6", "#38e54d"] },
  { name:"Sunrise Flash", style:"Pop", mainColor:"Orange", img:"https://dummyimage.com/180x180/ef7800/fff&text=Sunrise+Flash", desc:"Collection sp√©ciale pour briller !", palette:["#ef7800","#ffd23c","#fff"] },
  { name:"Minimal Shadow", style:"Minimaliste", mainColor:"Noir", img:"https://dummyimage.com/180x180/181c28/fff&text=Minimal+Shadow", desc:"L'essence de la sobri√©t√©, version e-sport.", palette:["#181c28", "#fff", "#ffd23c"] },
  { name:"Classic Volt", style:"Club", mainColor:"Jaune", img:"https://dummyimage.com/180x180/ffd23c/333&text=Classic+Volt", desc:"Inspir√© des plus grands clubs historiques.", palette:["#ffd23c", "#232850", "#38e54d"] },
  { name:"Green Pulse", style:"Sport", mainColor:"Vert", img:"https://dummyimage.com/180x180/38e54d/fff&text=Green+Pulse", desc:"Fra√Æcheur et √©nergie sur la sc√®ne.", palette:["#38e54d", "#fff", "#232850"] }
];

function renderPrefaitDesigns() {
  const style = document.getElementById('styleFilter').value;
  const color = document.getElementById('mainColorFilter').value;
  const search = document.getElementById('searchDesign').value.trim().toLowerCase();
  let list = designsData.filter(d =>
    (!style || d.style === style)
    && (!color || d.mainColor === color)
    && (!search || d.name.toLowerCase().includes(search) || d.desc.toLowerCase().includes(search))
  );
  const grid = document.getElementById('designsGrid');
  grid.innerHTML = '';
  list.forEach((d,i) => {
    const card = document.createElement('div');
    card.className = 'design-card';
    card.tabIndex=0;
    card.innerHTML = `
      <img src="${d.img}" alt="${d.name}">
      <div class="card-title">${d.name}</div>
      <div class="palette">
        ${d.palette.map(col=>`<span class="color-dot" style="background:${col}"></span>`).join('')}
      </div>
      <div class="card-desc">${d.desc}</div>
      <button class="choose-btn">Choisir ce design</button>
    `;
    card.querySelector('.choose-btn').onclick = e => {
      e.stopPropagation();
      Array.from(document.getElementsByClassName('design-card')).forEach(cd=>cd.classList.remove('selected'));
      card.classList.add('selected');
      alert('Le design ¬´ '+d.name+' ¬ª a √©t√© s√©lectionn√© !');
    };
    card.onclick = _ => {
      Array.from(document.getElementsByClassName('design-card')).forEach(cd=>cd.classList.remove('selected'));
      card.classList.add('selected');
    };
    grid.appendChild(card);
  });
}

['styleFilter','mainColorFilter','searchDesign'].forEach(id=>{
  document.getElementById(id).addEventListener('input',renderPrefaitDesigns);
});

document.querySelectorAll('input[name="designMode"]').forEach(rb=>{
  rb.addEventListener('input',function() {
    const isLibre = rb.value === 'libre';
    document.getElementById('block-prefait').style.display = isLibre ? 'none' : 'block';
    document.getElementById('block-libre').style.display = isLibre ? 'flex' : 'none';
    document.getElementById('prefait-carousel').style.display = isLibre ? 'none' : 'flex';
    document.getElementById('sidebarCustom').style.display = isLibre ? 'flex' : 'none';
    document.getElementById('bottomBarPro').style.display = isLibre ? 'flex' : 'none';
    document.getElementById('leftTipBlock').style.display = isLibre ? 'flex' : 'none';
  });
});

window.addEventListener('DOMContentLoaded', function() {
  const mode = document.querySelector('input[name="designMode"]:checked').value;
  document.getElementById('leftTipBlock').style.display = mode === 'libre' ? 'flex' : 'none';
});

renderPrefaitDesigns();

// Gestion des menus dropdown
document.querySelectorAll('.menu-dropdown > .bar-btn').forEach(btn=>{
  btn.addEventListener('click',function(e){
    const menu = btn.parentElement;
    document.querySelectorAll('.menu-dropdown').forEach(dd=>{
      if(dd===menu) { dd.classList.toggle('open'); } else { dd.classList.remove('open'); }
    });
    e.stopPropagation();
  });
});

window.addEventListener('click',e=>{
  if(!e.target.closest('.menu-dropdown')) {
    document.querySelectorAll('.menu-dropdown').forEach(dd=>dd.classList.remove('open'));
  }
});

window.addEventListener('keydown',e=>{
  if(e.key==="Escape") {
    document.querySelectorAll('.menu-dropdown').forEach(dd=>dd.classList.remove('open'));
  }
});

// Gestion du picker de couleur
document.body.addEventListener('click', function(e){
  if(e.target.closest(".custom-picker-trigger")){
    document.getElementById("customColorPicker").style.display = "block";
    e.stopPropagation();
  } else if(!e.target.closest(".custom-color-picker")){
    closePicker();
  }
});

function closePicker() {
  const picker = document.getElementById("customColorPicker");
  if(picker) picker.style.display = "none";
}

function validateCMJN() { 
  alert("Couleur valid√©e !"); 
  closePicker();
}

// Contr√¥les du mod√®le 3D
document.getElementById('resetCamera')?.addEventListener('click', function() {
  const modelViewer = document.getElementById('maillot3d');
  if (modelViewer) {
    modelViewer.resetTurntableRotation();
    modelViewer.jumpCameraToGoal();
  }
});

let autoRotate = true;
document.getElementById('toggleRotation')?.addEventListener('click', function() {
  const modelViewer = document.getElementById('maillot3d');
  const btn = this;
  if (modelViewer) {
    autoRotate = !autoRotate;
    modelViewer.autoRotate = autoRotate;
    btn.classList.toggle('active', autoRotate);
    btn.innerHTML = autoRotate ? 
      '<span class="material-icons">pause</span> Arr√™ter rotation' : 
      '<span class="material-icons">play_arrow</span> Auto-rotation';
  }
});

// Changement de couleur via les color-dots
document.querySelectorAll('.color-dot[data-color]').forEach(dot => {
  dot.addEventListener('click', function() {
    const color = this.dataset.color;
    // Ici vous pourrez ajouter la logique pour changer la couleur du mod√®le 3D
    console.log('Couleur s√©lectionn√©e:', color);
    
    // Animation visuelle
    document.querySelectorAll('.color-dot').forEach(d => d.classList.remove('active'));
    this.classList.add('active');
  });
});

// Animation de rotation pour l'ic√¥ne de chargement
const style = document.createElement('style');
style.textContent = `
  @keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }
`;
document.head.appendChild(style);
</script>

</body>
</html>
